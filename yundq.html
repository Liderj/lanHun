<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no">
    <!-- 页面描述 -->
    <meta name="description" content="不超过150个字符" />
    <!-- 页面关键词 -->
    <meta name="keywords" content="" />
    <title>运动圈</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <link rel="stylesheet" type="text/css" href="./css/reset.css">
    <link rel="stylesheet" type="text/css" href="./css/common.css">
    <link rel="stylesheet" type="text/css" href="./css/yundq.css">
    <link rel="stylesheet" type="text/css" href="./css/dropload.css">
    <link href="./node_modules/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
</head>

<body>
    <header class="text-center">
        <a href="javascript:history.back()">
            <img class="icon" src="./img/icon/back.png" alt="">
        </a>
        蓝魂
    </header>
    <img src="./img/icon/lrq.png" class="img-responsive" alt="">

    <div class="content container-fluid">
        <div class="nav-btn clearfix row">
            <div class="col-xs-4 text-center">
                <a href=""><img src="./img/icon/phb.png" alt=""> <br>排行榜</a>
            </div>
            <div class="col-xs-4 text-center">
                <a href=""><img src="./img/icon/qd.png" alt=""><br>球队</a>
            </div>
            <div class="col-xs-4 text-center">
                <a href=""><img src="./img/icon/qy.png" alt=""><br>球员</a>
            </div>
        </div>
        <div class="list">
            <section>
                <div class="player-info clearfix">
                    <div class="col-xs-3"><img src="./img/timg.jpg" alt=""></div>
                    <div class="col-xs-9">
                        <span>骑驴出山 得分后卫</span>
                        <label>四川省成都市xxxxxxxxx</label>
                        <label>2016-12-21  15:00</label>
                    </div>
                </div>
                <div class="player-center">
                    <div class="center-text">篮球感悟：萨达四大三季 度会看见爱上的看法服务我会儿或短索多 就看到很快就阿萨德卡萨丁就看到很快就阿萨德卡萨丁 爱的卡时间段发
                    </div>
                    <div class="center-img clearfix">
                        <img src="./img/timg.jpg" class="col-xs-4" alt="">
                        <img src="./img/timg.jpg" class="col-xs-4" alt="">
                        <img src="./img/timg.jpg" class="col-xs-4" alt="">
                    </div>
                </div>
                <div class="action text-right">
                    <span class="like"></span>
                    <img class="talk-btn" src="./img/icon/pl.png" alt="">
                </div>
                <div class="talk row">
                    <ul>
                        <li><i>张三:</i>sadasdasdsadsadas dadassadasdasdsadsadasdad </li>
                        <li><i>张三张三张三:</i>sadasdasdsadsadasdadas</li>
                        <li><i>张三张三:</i>sadasdasdsadsadasdadas</li>
                        <li><i>张:</i>评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论</li>
                    </ul>
                    <div class="dialog">
                        <input type="text" name="" value="">
                        <button class='send'>发送</button>
                    </div>

                </div>
            </section>

            <section>
                <div class="player-info clearfix">
                    <div class="col-xs-3"><img src="./img/timg.jpg" alt=""></div>
                    <div class="col-xs-9">
                        <span>骑驴出山 得分后卫</span>
                        <label>四川省成都市xxxxxxxxx</label>
                        <label>2016-12-21  15:00</label>
                    </div>
                </div>
                <div class="player-center">
                    <div class="center-text">篮球感悟：萨达四大三季 度会看见爱上的看法服务我会儿或短索多 就看到很快就阿萨德卡萨丁就看到很快就阿萨德卡萨丁 爱的卡时间段发
                    </div>
                    <div class="center-img clearfix">
                    </div>
                </div>
                <div class="action text-right">
                    <span class="like"></span>
                    <img class="talk-btn" src="./img/icon/pl.png" alt="">
                </div>
                <div class="talk row">
                    <ul>
                        <li><i>张三:</i>sadasdasdsadsadas dadassadasdasdsadsadasdad </li>
                        <li><i>张三张三张三:</i>sadasdasdsadsadasdadas</li>
                        <li><i>张三张三:</i>sadasdasdsadsadasdadas</li>
                        <li><i>张:</i>评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论评论</li>
                    </ul>
                    <div class="dialog">
                        <input type="text" placeholder="不超过200字" value="">
                        <button class='send'>发送</button>
                    </div>

                </div>
            </section>
        </div>
    </div>

    </div>
    <footer>
        <a href="index.html" class="col-xs-6 text-center ">首页</a>
        <a href="uCenter.html" class="col-xs-6 text-center active">运动圈</a>
    </footer>
    <script type="text/javascript" src="./node_modules/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="./js/dropload.min.js"></script>

    <script>
        $(function() {

            $('.center-img img').on('click', function() {
                var imgSrc = $(this).attr("src");
                getImageWidth(imgSrc, function(w, h) {
                    console.log({
                        width: w,
                        height: h
                    });
                });
            });

            // 滚动加载
            var page = 0;
            // 每页展示5个
            var size = 5;
            // dropload
            $('.content').dropload({
                scrollArea: window,
                loadDownFn: function(me) {
                    page++;
                    var result = '';
                    $.ajax({
                        type: 'GET',
                        url: 'http://ons.me/tools/dropload/json.php?page=' + page + '&size=' + size,
                        dataType: 'json',
                        success: function(data) {
                            var arrLen = data.length;
                            if (arrLen > 0) {
                                for (var i = 0; i < arrLen; i++) {
                                    // 拼接HTML  按上面的html中<section>拼接数据 每一个<section>
                                    // 为一个item
                                    result += '<section><a class="item opacity" href="' + data[i].link + '">' +
                                        '<img src="' + data[i].pic + '" alt="">' +
                                        '<h3>' + data[i].title + '</h3>' +
                                        '<span class="date">' + data[i].date + '</span>' +
                                        '</a></section>';
                                }
                            } else {
                                // 如果没有数据锁定
                                me.lock();
                                // 无数据
                                me.noData();
                            }
                            // 插入数据到页面，放到最后面
                            $('.list').append(result);
                            // 每次数据插入，必须重置
                            me.resetload();
                        },
                        error: function(xhr, type) {
                            alert('网络错误');
                            // 即使加载出错，也得重置
                            me.resetload();
                        }
                    });
                }
            });


        });

        function getImageWidth(url, callback) {
            var img = new Image();
            img.src = url;

            // 如果图片被缓存，则直接返回缓存数据
            if (img.complete) {
                callback(img.width, img.height);
            } else {
                // 完全加载完毕的事件
                img.onload = function() {
                    callback(img.width, img.height);
                }
            }

        }

        $('.talk-btn').on('click', function() {
            $(this).parents('section').find('.dialog').fadeToggle();
            $(this).parents('section').find('.dialog input')[0].focus();
            console.log($(this).parents('section').find('.dialog').scrollTop());

        });

        $('.send').on('click', function() {
            if ($(this).prev().val().length > 400) {
                alert('评论太长');
            } else if ($(this).prev().val()) {
                var html = '<li><i>' + '李四:' + '</i>' + $(this).prev().val() + '</li>';
                $(this).parents('.talk').find('ul').append(html);
                $(this).parents('.dialog').hide();
                $(this).prev().val('');
            } else {
                alert('评论不能为空');
            }

        });

        $('.like').on('click', function() {
            $(this).hasClass('liked') ? $(this).removeClass('liked') : $(this).addClass('liked');
        });
    </script>
</body>

</html>
